---
title: "'Analyse tikkertje data'"
output:
      html_document:
        keep_md: true
      github_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
## Inleiding

Als eerste stap bekijken we de gegevens vergaard tijdens de experimenten. De 'opgekuiste' gegevens zijn als volgt:

```{r show_data}
data <- read.csv("data/schone_data.csv")
data <- data[c("n_spelers", "n_lopers", "n_tikkers", "n_getikt", "duur")]
knitr::kable(data, col.names = c("# spelers", "# lopers", "# tikkers", "# getikt", "duur [sec]"))
```

Het uiteindelijke doel is om een zo goed mogelijke voorspelling te verkrijgen voor de duurtijd van het spel als functie van de verhouding van het aantal tikkers ten opzichte van het aantal lopers. Om dit 'correct' te doen zijn er veel te weinig gegevens. In principe is dit een dynamisch spel dat waarschijnlijk (niet exhaustief) beïnvloed wordt door het aantal tikkers en lopers, de geometrie van het veld, de strategie van de lopers en tikkers en de fitheid van de lopers en tikkers. Bovendien zal de invloed van deze variabelen hoogst waarschijnlijk niet constant zijn maar variëren in de tijd, afhankelijk van de andere variabelen (de fitheid van de spelers zal bijvoorbeeld zeker niet constant blijven). De hoeveelheid gegevens daarentegen is beperkt. De bovenstaande dataset bevat slechts `r nrow(data)` observaties.

Om deze reden zullen we het hier zo simpel mogelijk houden. De enige controleerbare factor is de verhouding van het aantal tikkers ten opzichte van het aantal spelers. Deze kunnen we gebruiken om te proberen te voorspellen hoeveel lopers er per tijdseenheid netto uit het spel verdwijnen. Met netto wordt hier bedoeld hoeveel er worden getikt min het aantal getikten die worden bevrijd.

## Additiviteit assumptie

De eerste ruwe benadering die we gebruiken is dat het aantal lopers dat netto per seconde wordt getikt constant blijft gedurende het spel. Met andere woorden, als we $L_t$ gebruiken voor het aantal vrije lopers na $t$ seconden en $y$ het netto aantal lopers dat per seconde getikt wordt, dan hebben we:
$$L_t = N_0-yt$$
Dit netto aantal getikten per seconde, $y$, kan dan geschat worden als
$$y \approx \frac{G_t}{t}$$
waar $G_t$ het aantal getikten na $t$ seconden is. We kunnen dan, op basis van de data, pogen om $y$ te voorspellen als functie de verhouding van het aantal tikkers, $T$, ten opzichte van het totaal aantal spelers, $L + T$:
$$y = f\left(\frac{T}{L + T}\right)$$.
Deze functie zou in principe aan de volgende eigenschappen moeten voldoen: $f\left(0\right) = 0$, $f\left(1\right) = 0$, $f'\left(0^+\right) > 0$. 
We beginnen met de bovenstaande gegevens grafisch voor te stellen.
```{r plot_additief, echo = FALSE}
data_mod <- data.frame(y = 60 * data$n_getikt / data$duur,
                       x = data$n_tikkers / data$n_lopers,
                       stringsAsFactors = FALSE)
# kleur de punten in functie van het totaal aantal spelers
data_mod$color <- ifelse(data$n_spelers < 30, "green", "blue")
data_mod$color[data_mod$y == 0] <- "red"
# geef een verschillend symbool aan spelletjes die voortijdig gestopt zijn
data_mod$pch <- ifelse(data$n_lopers == data$n_getikt, 3, 19)
opar <- par(mar = c(5.1, 4.1, 1.1, 1.1))
plot(data_mod$x, data_mod$y, col = data_mod$color, pch = data_mod$pch,
     main = "", xlab = expression(T[0]/L[0]), ylab = "G per minuut",
     xlim = range(0, range(data_mod$x)))
text(data_mod$x, data_mod$y, col = data_mod$color, labels = data$n_spelers,
     cex = 0.75, adj = - 0.35)
abline(v = 40 / 1500, lty = "dashed", col = "lightgray")
text(40 / 1500, 0, col = "lightgray", labels = "40/1500", cex = 0.75, adj = -0.25)
legend("topleft", pch = c(3, 19), legend = c("Iedereen getikt", "Vroegtijdig gestopt"), bty = "n")
par(opar)
```

